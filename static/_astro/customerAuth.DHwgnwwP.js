import{C as m}from"./index.Br6pAFfs.js";async function d(t){const e=await fetch(m,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`${t}`},body:JSON.stringify({query:`
        query {
          customer {
            firstName
            lastName
            emailAddress { emailAddress }
          }
        }
      `})});if(!e.ok)return null;const a=await e.json();if(a.errors||!a.data?.customer)return null;const o=a.data.customer;return{firstName:o.firstName??null,lastName:o.lastName??null,email:o.emailAddress?.emailAddress??null}}const h="oauth_return_to";function f(){return window.location.pathname+window.location.search+window.location.hash}function i(t){let e="";for(const n of t)e+=String.fromCharCode(n);return btoa(e).split("+").join("-").split("/").join("_").split("=").join("")}async function p(t){const e=await crypto.subtle.digest("SHA-256",new TextEncoder().encode(t));return i(new Uint8Array(e))}async function g(t){const e="pureplantdev.myshopify.com",a="1bebf8ab-21a5-49e2-87d1-083d826e2fac",o=`${window.location.origin}/auth/callback`;sessionStorage.setItem(h,t??f());const r=await fetch(`https://${e}/.well-known/openid-configuration`).then(l=>l.json()),n=i(crypto.getRandomValues(new Uint8Array(32)));sessionStorage.setItem("pkce_verifier",n);const u=await p(n),c=crypto.randomUUID();sessionStorage.setItem("oauth_state",c);const s=new URL(r.authorization_endpoint);s.searchParams.set("client_id",a),s.searchParams.set("response_type","code"),s.searchParams.set("scope","openid email customer-account-api:full"),s.searchParams.set("redirect_uri",o),s.searchParams.set("code_challenge",u),s.searchParams.set("code_challenge_method","S256"),s.searchParams.set("state",c),window.location.href=s.toString()}async function S(){const t=localStorage.getItem("customer_access_token");return t?await d(t)?"signedIn":(localStorage.removeItem("customer_access_token"),"signedOut"):"signedOut"}export{d as f,S as g,g as s};
